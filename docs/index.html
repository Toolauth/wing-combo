<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>toolauth-hardware</title>
        <link rel="stylesheet" href="styles.css">
    </head>
    <style>
        #tldr, mark{
            background-color: black;
            color:white; 
            padding:6px;
        }
    </style>

    <body>
        <img src="social.png" style="width:max(60%, 500px);"> 
        <p id="tldr">TLDR: the designs are described withtin <a href="https://github.com/crice009/toolauth-hardware" style="color:lightblue">this repo</a>. Board details at the <a href="#assemble" style="color:lightblue">bottom</a>...</p>
        <h1>Where might this system be useful?</h1>
        <p>First, who might want to use a system to control access to tools? Let's introduce you to MakeHaven, a nonprofit Fab Lab/ Makerspace in New Haven, Connecticut, USA:</p>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/qBZH4NdUpAE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        <p>Tool authorization has been a safety mainstay of MakeHaven for years. This is the hardware that makes that safety measure possible. It has gone through several generations, and contributions from many individuals.</p>
        <h2><mark>High Level Overview:</mark></h2>
        <p>
            MakeHaven members do a short training process to aquire authorization for a new tool, and then can gain access to use it. Some members have access to nearly all the tools, well in excess of 100 items.
            Although most members do not need to worry about the details, they can use an RFID card to access tools for which they have been authorized. Behind the scenes, this system runs on some custom hardware 
            and a database that manages and logs members' access. The collective effect of all this is that the shop is much safer, better managed, and more easily insured. 
        </p>
        <hr/>
        <h1>The Details:</h1>
        <p>Jump to the bottom to get all the nitty gritty, but here we start to answer 'How?'</p>
        <h2><mark>Software</mark></h2>
        <p>The software integrates many layers: a complex web server, database, and firmware to bring together the constellation of devices that are required to make this system operate.
        <h3>Server</h3>
        <p>
            There is a custom server that facilitates communication between all the devices in this system. It references a databases, generates logs, and actually determines authorization from available data. The server itself is a set of <a href="https://www.docker.com/">Docker</a> containers that can be built and managed easily.
            Many of these are nearly stock installations, of things like <a href="https://www.home-assistant.io/">Home Assistant</a> and <a href="https://esphome.io/">ESPHome</a>. However, there is one crritical custom container that brings all of these together. This is described in its own GitHub repo [currently private, will link later].
        </p>
        <h3>Database</h3>
        <p>
            The database is currently house in the MakeHaven website itself, but there are plans to migrate this to a separate database for future evolution of this tool authorization system. Additionally, local caching of the database allows for faster access determination and an ability to keep the system running if internet service is interrupted in the makerspace.
        </p>
        <h3>Firmware</h3>
        <p>
            As an extension of ESPHome, the Firmware is compiled from YAML. This firmware is built from a shared set of files, with each individual device having only a single 'main file' to differentiate it. In that one 'main file' for each device, a tool controller, card reader, door locks, etc can be defined in as little as 50 lines of YAML. Connecting these devices must be done in coordination with the server and some network management.
        </p>
        <br/>
        <h2><mark>Hardware</mark></h2>
        <p>The hardware is what <a href="https://github.com/crice009/toolauth-hardware">this repo</a> is all about. The <a href="https://www.kicad.org/">KiCad</a> designs and other supporting information is what is contained here.</p>
        <h3>Main tool Controller</h3>
        <p id="tldr">This <a href="tool_controller.html" style="color:lightblue">custom-designed board</a> holds enough for an all-in-one hardware solution.</p>
        <p>
            The working pieces of this entire system is a set of IOT relays and contactors that control power flowing to tools in the workshop. This is all based around an ESP32 microcontroller, specifically with the "ESP32-DevKitC-V4+" footprint. The design here attaches that ESP32 to relays, a series of buttons and lights, I2C connections to RFID card readers, 
            a dedicated ADE7953 current sensor to monitor the tool's use and more. The ESP32 seats in place, and a few wires connect the needed external buttons to make a fully operational tool control box. 
        </p>
        <img src="img/v1.3.png" style="width:min(100%, 600px);">
        <p>
            These boxes should be wired in-line with power to the tool they control and mounted nearby for easy operation.
        </p>
        <h3>RFID Reader Board</h3>
        <p>
            Often, it is helpful to have an RFID card reader that is in a different location than the tool or door activator that is related. The design of <a href="reader_daughter.html">this small baord</a> is just enough to connect an ESP32 to an I2C card reader and the small amount of hardware to make an effective stand-alone card reader.
            As a sheer bonus, there is enough space added in for a <a href="https://esphome.io/components/display/waveshare_epaper.html">Waveshare E-paper Display</a> in case that may be useful to the system in the future.
        </p>
        <hr/>
        <h1 id="assemble">Board Details</h1>
        <ul style="font-size: x-large;">
            <li><a href="tool_controller.html">Tool Controller Board</a></li>
            <li><a href="reader_daughter.html">Reader Daughter Board</a></li>
        </ul>
    </body>

</html>