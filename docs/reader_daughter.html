<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>toolauth-hardware</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <img src="social.png" style="width:max(60%, 500px);">
    <a href="index.html" class="button">Home</a>
    <h1>Reader Daughter Board</h1>
    <hr/>
    <h1>Daughter Board</h1>
    <p>It is commonly helpful to have a small, dedicated device to read a member's RFID badge. This board can be mounted under an <a href="https://www.espressif.com/en/products/devkits/esp32-devkitc" target="_blank" rel="noopener noreferrer">ESP32 DevKitC Boards</a>,
        <a href="https://www.olimex.com/Products/IoT/ESP32/ESP32-POE/open-source-hardware" target="_blank" rel="noopener noreferrer">Olimex-POE</a> or an <a href="https://www.olimex.com/Products/IoT/ESP32/ESP32-POE-ISO/open-source-hardware" target="_blank"
            rel="noopener noreferrer">Olimex-POE-ISO board</a>.</p>
    <div>
        <img src="img/rd-design.png" height="250px">
    </div>
    <p>The design shown above allows the easy connection of a few types of microcontrollers to common devices. These can be used for card-readers of E-Ink displays among other things.</p>
    <p>The red-covered components are shown, but not included in the most recent production-run of the board: It is commonly convenient to solder these components in later, as you may want them configured differently for different applications. For example, although shown on the top here, the buzzer will often be placed on the bottom of the board to direct the noise outward.</p>
    <p>The gerber Files for this design are <a href="https://github.com/crice009/toolauth-hardware/raw/main/reader-daughter/reader-daughter-gerbers.zip">here</a>, and the <a href="https://raw.githubusercontent.com/crice009/toolauth-hardware/main/reader-daughter/gerbers/parts-assembly/reader-daughter-BOM.csv">BOM</a>        and <a href="https://raw.githubusercontent.com/crice009/toolauth-hardware/main/reader-daughter/gerbers/parts-assembly/reader-daughter-top-pos.csv">position</a> files are formatted for ordering from <a href="https://jlcpcb.com/" target="_blank"
            rel="noopener noreferrer">JLCPCB</a>.</p>
    <hr/>
    <h1>Schematic</h1>
    <script>
        var url = 'https://raw.githubusercontent.com/crice009/toolauth-hardware/3678eeb80ebd88e62bd7c520f0fd4116a5019972/reader-daughter/schematic.pdf';
    </script>
    <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
    <script src="script.js"></script>
    <canvas id="the-canvas"></canvas>
    <p><a href="https://raw.githubusercontent.com/crice009/toolauth-hardware/3678eeb80ebd88e62bd7c520f0fd4116a5019972/reader-daughter/schematic.pdf">Download complete schematic.</a></p>
    <hr/>
    <h1>Top and bottom of board</h1>
    <div>
        <img src="img/rd-front.png" height="250px">
        <img src="img/rd-back.png" height="250px">
    </div>
    <hr/>
    <h1>3D models of Board Holders</h1>
    <p>The following are links to downloadable Fusion 360 models for these reader-holders.</p>
    <ul>
        <li><a href="https://a360.co/3PrpDu6" target="_blank" rel="noopener noreferrer">ESP32-DevKitC-V4+ (wireless) box</a></li>
        <li><a href="https://a360.co/3NFuJla" target="_blank" rel="noopener noreferrer">Olimex front-mounted (POE) box</a></li>
        <li><a href="https://a360.co/3q8p0LA" target="_blank" rel="noopener noreferrer">Olimex rear-mounted (POE) box</a></li>
    </ul>
    <p>Here is a rendered example of the first of these designs:</p>
    <iframe src="https://myhub.autodesk360.com/ue2b591a9/g/shares/SH512d4QTec90decfa6ed8a2353edbe67b1f" style="width:max(100%, 850px);aspect-ratio: 1;" title="Iframe Example"></iframe>
    <hr/>
    <h1>Detailed Explanation of Parts</h1>
    <p>There are a handful of places to interact with this board. They are explained below.</p>
    <hr/>
    <h2>Microcontoller Sockets</h2>
    <p>There are two possible Microcontrollers designed to interface with this board, each in their own set of headers.</p>
    <p>First is the <a href="https://www.espressif.com/en/products/devkits/esp32-devkitc">ESP32-DevKitC-V4+ group of boards</a> that are commonly <a href="https://a.co/d/isbnsil">available for sale online</a>. These boards fit into the longer (19 pin) pair of headers.</p>
    <p>Second is the <a href="https://www.olimex.com/Products/IoT/ESP32/ESP32-POE/open-source-hardware">Olimex ESP32-POE</a> or the <a href="https://www.olimex.com/Products/IoT/ESP32/ESP32-POE-ISO/open-source-hardware">Olimex ESP32-POE-ISO</a> boards. These both fit on the 10-pin headers.</p>
    <div>
        <img src="img/rd-esp32.png" height="250px">
        <img src="img/rd-poe.png" height="250px">
    </div>
    <hr/>
    <h2>I2C Connector</h2>
    <p>For this project, <mark>this is where the card reader will connect.</mark>I2C communication is generally helpful for most types of chip-to-chip communication.</p>
    <p>On the front, there is the JST connector, and two open spots where you could add resisitors. On the back of the baord there are two already-connected jumpers. These resistors and spaces for more are all in place because of the need for I2C communication to have pull-up resistors. The default state is to use the pull-up resistors on the microcontroller. If you need more resistance (because of spotty communication) you can cut the trace between the pads on JP3 and JP4 to add in the 2.2k resistors that are already soldered in parallel to the jumpers. IF you find that this still doesn't solve your communication problems, then you can solder in whatever resistors work of your application in the open spaces for R7 and R8. Hopefully, all these pull-up resistors will not be needed, and you can leave the setup as-is.</p>
    <div>
        <img src="img/rd-i2c.png" height="250px">
        <img src="img/rd-rear-i2c.png" height="250px">
    </div>
    <hr/>
    <h2>SPI Communication</h2>
    <p>An SPI connector was added because it may be helpful for general use. There is no specific reason it is there, but perrhaps on will present itself...</p>
    <div>
        <img src="img/rd-spi.png" height="250px">
    </div>
    <hr/>
    <h2>Waveshare E-Ink Connection</h2>
    <p>ESPHome has good integration for <a href="https://esphome.io/components/display/waveshare_epaper.html">Waveshare E-Paper displays</a>. Here are the configuration options for using the E-Ink display.</p>
    <table class="docutils align-default">
        <tbody>
        <tr class="row-odd"><td><p><strong>E-Paper Pin</strong></p></td>
        <td><p><strong>ESP Pin</strong></p></td>
        <td><p><strong>ESPHome Option</strong></p></td>
        </tr>
        <tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VCC</span></code></p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">3.3V</span></code></p></td>
        <td><p>N/A</p></td>
        </tr>
        <tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GND</span></code></p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">GND</span></code></p></td>
        <td><p>N/A</p></td>
        </tr>
        <tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CLK</span></code></p></td>
        <td><p>GPIO 18</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">spi.clk_pin</span></code></p></td>
        </tr>
        <tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DIN</span></code></p></td>
        <td><p>GPIO 19</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">spi.mosi_pin</span></code></p></td>
        </tr>
        <tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CS</span></code></p></td>
        <td><p>GPIO 17</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">cs_pin</span></code></p></td>
        </tr>
        <tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DC</span></code></p></td>
        <td><p>GPIO 16</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">dc_pin</span></code></p></td>
        </tr>
        <tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BUSY</span></code> (Optional)</p></td>
        <td><p>GPIO 25</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">busy_pin</span></code></p></td>
        </tr>
        <tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RESET</span></code> (Optional)</p></td>
        <td><p>GPIO 26</p></td>
        <td><p><code class="docutils literal notranslate"><span class="pre">reset_pin</span></code></p></td>
        </tr>
        </tbody>
        </table>
        <p>Here is an example configuration for ESPHome, but you'll clearly want to change the messages...</p>
        <pre><span></span><span class="c1"># Example configuration entry</span>
            <span class="nt">font</span><span class="p">:</span>
            <span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">'fonts/Comic</span><span class="nv"> </span><span class="s">Sans</span><span class="nv"> </span><span class="s">MS.ttf'</span>
            <span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">font1</span>
            <span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l">8</span>
            
            <span class="nt">spi</span><span class="p">:</span>
            <span class="w">  </span><span class="nt">clk_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO18</span>
            <span class="w">  </span><span class="nt">mosi_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO19</span>
            
            <span class="nt">display</span><span class="p">:</span>
            <span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l">waveshare_epaper</span>
            <span class="w">    </span><span class="nt">cs_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO17</span>
            <span class="w">    </span><span class="nt">dc_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO16</span>
            <span class="w">    </span><span class="nt">busy_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO25</span>
            <span class="w">    </span><span class="nt">reset_pin</span><span class="p">:</span><span class="w"> </span><span class="l">GPIO26</span>
            <span class="w">    </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l">2.90in</span>
            <span class="w">    </span><span class="nt">full_update_every</span><span class="p">:</span><span class="w"> </span><span class="l">30</span>
            <span class="w">    </span><span class="nt">lambda</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
            <span class="w">      </span><span class="no">it.print(0, 0, id(font1), "Hello World!");</span>
            </pre>
            <p>Finally, the pinout for the Waveshare is located here, and labeled on the back of the board for easier soldering of the often-included display connector cables. Here is an <a href="https://www.waveshare.com/2.9inch-e-paper-module.htm">example of the waveshare boards</a>, but they are available from many resellers, including <a href="https://a.co/d/dse3aka">Amazon</a>.</p>
            <div>
                <img src="img/rd-waveshare.png" height="250px">
                <img src="img/rd-rear.png" height="250px">
            </div>
            <hr/>
            <h2>Buzzer</h2>
            <p>A little noise is great feedback. A 12mm buzzer such as <a href="https://a.co/d/hux467i">this one</a> can be soldered into place easily. The polarity and controlling pins have been silkscreened onto both sides of the board, to faciliate easier use with either choice of placement.</p>
            <p><mark>Often the Buzzer will be soldered directly onto the back of these boards - watch polarity.</mark></p>
            <div>
                <img src="img/rd-buzzer.png" height="250px">
            </div>
            <hr/>
            <h2>Red/Green LED</h2>
            <p>Indicator LEDs can provide great feedback to a used. Two-color LEDs like <a href="https://a.co/d/f0ygv3q">this</a> may be an old-solution, but they do a great job as indicators without taking many pins. including a full RGB LEd is possible on this board, but avoided to stay inline with the paired <a href="tool_controller.html">tool-controller</a> boards that can only fit this pinout.</p>
            <p>The pin spacing here is perfect for one of the LEDs on its own, or to solder in a small terminal block. <mark>Often the R/G LED will be soldered directly onto the back of these boards - watch polarity.</mark></p>
            <div>
                <img src="img/rd-led.png" height="250px">
            </div>
</body>

</html>