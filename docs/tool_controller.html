<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>toolauth-hardware</title>
    <link rel="stylesheet" href="styles.css">
</head>


<body>
    <img src="social.png" style="width:max(60%, 500px);">
    <a href="index.html" class="button">Home</a>
    <h1>Tool Controller Board</h1>
    <hr/>
    <h2>Schematic</h2>
    <script>
        var url = 'https://raw.githubusercontent.com/crice009/toolauth-hardware/7eeae54f7607a041a097446be69f44f0605fca48/V1.3/schematic.pdf';
    </script>
    <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
    <script src="script.js"></script>
    <canvas id="the-canvas"></canvas>
    <p><a href="https://raw.githubusercontent.com/crice009/toolauth-hardware/7eeae54f7607a041a097446be69f44f0605fca48/V1.3/schematic.pdf">Download complete schematic.</a> Schematic PDF is a snapshot in time, may be slightly out of date from the design files.</p>
    <hr/>
    <h1>E-Stop arrangements:</h1>
    <p>Recommended components for each E-Stop:</p>
    <ul>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/emergency_stop_pushbuttons/ar22v0l-01e3r" target="_blank" rel="noopener noreferrer">E-Stop assembly [ar22v0l-01e3r] - base of E-Stop switch</a></li>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/pushbutton_-z-_switch_-z-_indicator_accessories/contact_blocks_-z-_mounting_flanges/ar9b291" target="_blank" rel="noopener noreferrer">NC Block extension [ar9b291] - second half E-Stop</a></li>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/pushbutton_-z-_switch_-z-_indicator_accessories/contact_blocks_-z-_mounting_flanges/ar9b290" target="_blank" rel="noopener noreferrer">NO Logic switch [ar9b290] - feedback/control LED</a></li>
        <li>1x <a href="https://a.co/d/0GzJoSd" target="_blank" rel="noopener noreferrer">BA9S white LED light for ~5Vdc (many options from auto industry)</a></li>
    </ul>
    <hr/>
    <h2>Setting up an E-Stop switch</h2>
    <p>An E-Stop must be built from a multi-part switch system. Each E-Stop should comprise two N-ON switches rated for more than 4A AC current, an indicator LED, and a low-voltage N-OFF switch.</p>
    <p>What is shown below is how the two low-voltage components [lamp and switch] must be configured. The three outbound wires must be soldered to work with a JST connector. </p>
    <p>There is one trick part to making an E-Stop: you need to connect the low-voltage components correctly with wires at the switch, and then solder leads onto a JST female connector correctly. This can take some doing, and you will need to test these
        connections for each E-Stop switch that you assemble.</p>
    <div>
        <img src="img/estop-config.png" height="250px">
        <img src="img/estop-jst.png" height="250px">
    </div>
    <hr/>
    <h2>Two E-Stops</h2>
    <p>This configuration is best for when you have an E-Stop on the controller box, and want another mounted closer to where the user will actually be working. A good example is having a second E-Stop right on the front of a Bridgeport Mill.</p>
    <p>The control box's E-Stop [A] should be plugged in at all the green locations. The secondary E-Stop should be plugged in to all the blue locations.</p>
    <img src="img/v1.3-two-estop.png" style="width:min(100%, 600px);">
    <hr/>
    <h2>One E-Stop</h2>
    <p><mark>This configuration may be the most common.</mark> There is an E-Stop on the controller box, and none other.</p>
    <p>The control box's E-Stop [A] should be plugged in at all the green locations. Jumpers will need to be placed where the blue 'U' shapes show connections for E-Stop B. Do not use the E-Stop-B JST plug.</p>
    <img src="img/v1.3-one-estop.png" style="width:min(100%, 600px);">
    <hr/>
    <h2>No E-Stops</h2>
    <p>This configuration is only for the very safest of tools, when the control box is perhaps undersized.</p>
    <p>Jumpers will need to be placed where the blue 'U' shapes show connections for E-Stops A & B. Do not use the E-Stop-A or E-Stop-B JST plugs.</p>
    <img src="img/v1.3-no-estop.png" style="width:min(100%, 600px);" ">
    <hr/>
    <h1>Current Sensor</h1>
    <p>The CT current sensor will be plugged into a 1/8" jack in this location. The current sensor itself should be of <a href="https://a.co/d/4anaNE2">this</a> kind of simple split-ring inductive sensor. The exact current rating of the sensor is
    not critical, but should be slightly above the value of the tool's circuit breaker; adjustments can be made in the firmware `offset` setting. [30A is a good fit for most.]</p>
    <p>The current sensor should be clamped around the 'hot' line headed out to the tool, from the contactor.</p>
    <div>
        <img src="img/current-clamp.jpg" height="250px">
        <img src="img/v1.3-current.png" height="250px">
    </div>
    <hr/>
    <h1>I2C Card Reader</h1>
    <p>The RFID card reader connects using one of the two available I2C connections (it does not matter which of these).</p>
    <p>The PN532 board should be like those shown <a href="https://a.co/d/duoIX52" target="_blank" rel="noopener noreferrer">here</a>. They should be configured for I2C communication (switch DIP as needed) and have wires soldered to leave the flattest-possible
        surface to mount the board.</p>
    <div>
        <img src="img/pn532-board.jpg" height="250px">
        <img src="img/v1.3-i2c.png" height="250px">
    </div>
    <hr/>
    <h1>Bypass Key</h1>
    <p>The controller box will need a bypass key-switch, such as those shown <a href="https://a.co/d/hHKVJxG" target="_blank" rel="noopener noreferrer">here</a>. This switch will need to connect to a 2-pin JST connector as shown on the board.</p>
    <div>
        <img src="img/key-switch.jpg" height="250px">
        <img src="img/v1.3-bypass.png" height="250px">
    </div>
    <hr/>
    <h1>Soldered-on Components</h1>
    <p>two components will need to be soldered by the end user.</p>
    <p>The 5V transformer will need to be soldered into place in the location marked "PS1" on the board.</p>
    <p>The Stage 2 relay will need soldering where indicated. It must be an "Omron MY2-02" relay to fit, but can be rated for 110VAC or 220VAC.</p>
    <p>It is advised that after soldering on these components (and arranging the E-Stops) you should set the DIP pins, as appropriate.</p>
    <div>
        <img src="img/v1.3-5vpower.png" height="250px">
        <img src="img/v1.3-stage2.png" height="250px">
    </div>
    <hr/>
    <h1>Other Connections</h1>
    <p>There are a handful of other connections that must be made on the right side of the board, to the mains-level control components that are panel-mounted on the box.</p>
    <hr/>
    <h2>Incoming Power</h2>
    <p>The power lines must be connected as shown, with the correct polarity for any single-phase applications. 'H' for the Hot line. 'N' for the neutral line.</p>
    <img src="img/v1.3-mains.png" style="width:min(100%, 600px);">
    <hr/>
    <h2>Out to Contactor</h2>
    <p>The external contactor should be mounted in the controller box, but the two wires coming out here should be used to activate it. These lines should only need to supply a relatively small current to control the state of the contactor.</p>
    <img src="img/v1.3-contactor.png" style="width:min(100%, 600px);">
    <hr/>
    <h2>Mains User I/O</h2>
    <p>The green light, green button, and red button should all connect here as shown.</p>
    <ul>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/pushbuttons/gcx3102" target="_blank" rel="noopener noreferrer">Green N.O. button [gcx3102]</a></li>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/pushbuttons/gcx3101" target="_blank" rel="noopener noreferrer">Red N.C. button [gcx3101]</a></li>
        <li>1x <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/indicating_lights/dr30d0l-e3gzc" target="_blank" rel="noopener noreferrer">Domed Green light [DR30D0L-E3GZC]</a> or <a href="https://www.automationdirect.com/adc/shopping/catalog/pushbuttons_-z-_switches_-z-_indicators/indicating_lights/ecx2052-24l"
                target="_blank" rel="noopener noreferrer">Flat green Light, cheaper [ECX2052-24L]</a></li>
    </ul>
    <img src="img/v1.3-power-io.png" style="width:min(100%, 600px);">
    <hr/>
    <h1>Other Notes</h1>
    <p>The USB port onboard is there to supply 5V DC to any secondary boards that may one-day be added to the controller boxes. This could include (but is not limited to) e-Ink displays to report reservations or tool status.</p>
    <p>The fuses must be in place for the board to function. 4 Amps is the recommended value for these fuses, but 2A or 3A may work equally well if 4A fuses are hard to source in this size. [5x20mm]</p>
    <p>The ESP32 boards at the heart of these devices must be "ESP32-DevKitC" but this footprint can include many options. Commonly, we use the ESP32-WROOM-32D such as <a href="https://a.co/d/32LINiH" target="_blank" rel="noopener noreferrer">these</a>.</p>
    <p>The Tool Controller box should be set-up with this layout configuration:</p>
    <img src="img/box-layout.svg" style="width:min(100%, 600px);">
</body>

</html>